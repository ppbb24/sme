# Smart Eye 装机调试 — Claude Code 任务书

## 第一步：阅读资料

请先阅读项目中的这些文件建立上下文：
1. **HANDOFF.md** — 装机调试和ODS的完整设计决策记录（流程、参数、状态、交互）
2. **Smart_Eye_装机调试与ODS交互Demo.jsx** — 已有的React原型代码，包含组件和交互逻辑
3. **所有 .png 图片** — Figma设计稿，作为视觉参考。其中 `2_2_装机调试-亮度.png` 是核心参考，所有页面的视觉风格严格对齐这张图

---

## 第二步：搭建项目

用 Vite + React 创建项目，安装 lucide-react 图标库。只实现「装机调试」功能，ODS后面再做。

---

## 第三步：视觉规范（严格对齐设计图）

仔细看 `2_2_装机调试-亮度.png` 和 `2_2_装机调试-位姿.png`，以下是需要像素级还原的视觉细节：

### 顶部导航栏（高度约44px）
- 左侧：Smart Eye 绿色圆角矩形logo（白色粗体文字）
- 三个导航项：「相机管理」带绿色图标、「工作台」当前高亮、「点位配方管理」带绿色图标
- 右侧：三个灰色工具图标 + 窗口控制按钮（最小化、最大化、关闭）

### 次顶部栏（步骤导航，高度约40px）
- 左侧：房子图标 + 「装机调试」文字，然后面包屑 `cam-line-1 / 左工位-引导 / config1`
- 中间：四步Tab用**箭头形状**相互连接（不是普通的Tab标签，是类似流程图的箭头造型）
  - 当前步骤：绿色背景 + 白色文字
  - 其他步骤：灰色背景 + 灰色文字
  - 通过的步骤：显示绿色勾 ✓
  - 失败的步骤：显示红色叉 ✗
- 右上角：绿色渐变「一键自动调试」按钮，带闪电图标

### 图像预览区（左侧主区域）
- 棋盘格透明背景（深灰交替方格）
- 工件图像居中显示，占据主要视觉空间
- 右上角：小型保存/截图图标按钮（半透明深色背景）
- 图像上的叠加标注随步骤切换

### 右侧参数面板（宽度约330px）
- 背景 #252525，左侧有 1px #333 边框分隔
- 顶部：步骤标题（如「亮度」），白色粗体
- 自动操作区：绿色渐变大按钮（圆角，占满面板宽度）+ 下方灰色提示文字
- 参数分组：用灰白色小标题分隔（如「光源亮度」「成像参数」「视野中心」）
- 滑块样式：
  - 标签文字在左（灰色，约68px宽）
  - 绿色已填充轨道 + 深灰未填充轨道（轨道高度3px）
  - 圆形绿色滑块头（12px，白色描边）
  - 右侧数值输入框（50px宽，深色背景，带上下箭头微调）
- ROI对列表：标题旁有 + 号按钮，每行显示名称 + 眼睛图标控制显隐

### 底部操作栏（高度约48px）
- 左侧或中间：「取图」按钮（仅位姿步骤有）
- 中间：「重置」按钮（灰色文字，透明背景）
- 右侧：「下一步」按钮（绿色渐变背景，白色文字，带右箭头）
- 最后一步按钮文字变为「完成」
- 按钮之间用 1px #333 竖线分隔

### 整体配色
```
背景主色：#1e1e1e
面板背景：#252525
次级背景：#2a2a2a
边框/分割：#333
输入框边框：#444
品牌绿/主色：#8bc34a
渐变绿按钮：linear-gradient(135deg, #8bc34a, #689f38)
成功/通过：#4caf50 / #8bc34a
失败/错误：#ef5350
文字标题：#eee
文字正文：#ccc
文字次要：#888
文字禁用：#666
```

### 字体
```
font-family: 'PingFang SC', 'Microsoft YaHei', 'Noto Sans SC', sans-serif;
```

---

## 第四步：实现装机调试完整功能

### 页面入口：工作台首页
- 浅灰色背景（区别于其他页面的深色）
- 标题「工作台」+ 副标题「请选择您的操作目标」
- 两张白色卡片并排：
  - 「制作标准样机」— 可点击，进入装机调试
  - 「ODS 批量快速装机」— 目前置灰或可点击但内容为空

### 装机调试四步（每步完整实现）

**第一步：位置与姿态**
- 自动按钮文案：「自动寻找中心并锁定」
- 执行中文案：「对位中...」
- 参数面板分三组：
  - 光源亮度：光源1(40)、光源2(40)、光源3(40)
  - 成像参数：曝光(80)、增益(2.00)、Gamma(0.7)
  - 视野中心：最大允许误差X(80)、最大允许误差Y(2.00)、图像中心(0.7)、视野ROI中心(0.7)
- 图像叠加：绿色十字虚线（图像中心）+ 蓝色虚线矩形框（视野ROI）

**第二步：清晰度**
- 自动按钮文案：「自动对焦」
- 执行中文案：「对焦中...」
- 参数：
  - 清晰度(80，只读数值展示)
  - 对焦模式：单选（自动对焦 / 手动对焦）
  - 对焦精度(80)
  - 对焦速度：三选一（低 / 中 / 高）
- 图像叠加：蓝色矩形框标注「自动对焦ROI」

**第三步：亮度**
- 自动按钮文案：「自动亮度优化」
- 执行中文案：「优化中...」
- 参数：
  - 亮度(60)
  - 成像参数组：曝光(80)、增益(2.00)、Gamma(0.7)
- ROI对管理（面板底部）：
  - 标题「ROI 对」旁有 + 按钮
  - 列表项：ROI_1、ROI_2，每行右侧眼睛图标控制显隐
  - 点击 + 可添加新ROI对
- 图像左上角实时数值（绿色等宽字体）：ROI_1 : 172.5 / ROI_2 : 67.5 / 差异值 : 105
- 图像叠加：FROI蓝色边框 + 标签、BROI蓝色边框 + 标签（两对ROI）

**第四步：色度**
- 自动按钮文案：「自动色度优化」
- 执行中文案：「优化中...」
- 参数：
  - R通道(1000，范围0-2000)
  - G通道(600，范围0-2000)
  - B通道(1000，范围0-2000)
- ROI只读引用：底部显示「当前使用亮度步骤中的ROI对」+ 绿色链接「前往调整ROI」（点击跳回第三步）
- 图像叠加：同亮度步骤的ROI框，但不可交互

### 四种状态全部可交互体验

| 状态 | Tab图标 | 面板表现 | 按钮状态 |
|------|---------|---------|---------|
| 待调试 | 无图标，灰色文字 | 参数可编辑，自动按钮可点击 | 重置/下一步可用 |
| 执行中 | Loading动画 | 按钮显示「XXX中...」+旋转图标，所有控件禁用 | 底部按钮禁用 |
| 通过 PASS | 绿色 ✓ | 参数更新为优化后的值，可再次点击重试 | 下一步高亮 |
| 失败 FAIL | 红色 ✗ | 提示手动调整，自动按钮恢复可用 | 下一步仍可用 |

### 一键自动调试流程
1. 点击右上角「一键自动调试」→ 弹出确认弹窗：「即将自动执行全部调试步骤，当前手动调整的参数将被覆盖，是否继续？」
2. 确认后按钮变为「调试中...」+ loading，底部按钮全部禁用
3. 依次执行四步，自动切换到当前执行的Tab
4. 每步耗时1-2秒，随机产生PASS或FAIL
5. 全部完成后弹出结果总览弹窗

### 保存弹窗（完成后或点击「完成」按钮）
- 标题「调试结果总览」
- 四步结果列表：每步名称 + ✓通过（绿色）或 ✗未通过（红色）
- 保存方式单选：
  - 覆盖原配方 (config1)
  - 另存为新配方（选中后出现名称输入框）
- 底部：取消 + 确认保存按钮
- 即使有步骤未通过也允许保存

---

## 第五步：确保能跑起来

- `npm run dev` 能正常启动
- 所有交互都能正常触发和响应
- 页面布局在 1440x900 分辨率下显示正常
- 没有控制台报错
